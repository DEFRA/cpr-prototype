{% set serviceName = "EPR for packaging data: manage your recycling obligations" %}

{% extends "layout.html" %}

{% block beforeContent %}
{{ govukBreadcrumbs({
  items: [
    {
      text: "Home",
      href: "../landing-page"
    },
    {
      text: "Search PRNs and PERNs",
      href: ""
    }

  ]
}) }}
{% endblock %}



{% block pageTitle %}
    {{serviceName}} prototype
{% endblock %}
{% block content %}


<!-----mobile res-->

<style>
  .govuk-table {
    width: 100%;
    border-collapse: collapse;
  }

  .govuk-table__header th, .govuk-table td {
    padding: 8px;
    text-align: left;
  }

  .govuk-table th {
    background-color: #ffffff;
  }

  .govuk-table__row:hover {
    background-color: #f1f1f1;
  }

  @media screen and (max-width: 600px) {
    .govuk-table thead {
      display: none;
      width: 100%;
    }

    .govuk-table tr {
      display: block;
      margin-bottom: 10px;
    }

    .govuk-table td {
      display: block;
      text-align: left;
      border: none;
      position: relative;
      padding-left: 50%;
    }

    .govuk-table td::before {
      content: attr(data-label);
      position: absolute;
      left: 0;
      width: 50%;
      padding-left: 10px;
      font-weight: bold;
      text-align: left;
    }

    .govuk-checkboxes__input {
    margin-right: 10px;
  }

  .govuk-checkboxes__label {
    display: flex;
    align-items: center;
  }
  
  .govuk-table__header--numeric {
    text-align: right;
  }

  }
</style>

<!-----Mobile res end-->



<div class="govuk-grid-row">
  <div class="govuk-grid-column-full">

    <div class="govuk-form-group">
      <h1 class="govuk-label-wrapper">
        <label class="govuk-label govuk-label--xl" for="event-name">
          Search PRNs and PERNs
        </label>
      </h1>
      <div id="event-name-hint" class="govuk-hint">
        You can only search for PRNs and PERNs issued to your 2025 recycling obligations. To find records from earlier years, use the National Packaging Waste Database (NPWD).      </div>
    </div>
    
<br>
    <div class="govuk-grid-column-full card">

      <form class="form" action="#" method="POST">

          <div class="govuk-form-group">
              <fieldset class="govuk-fieldset">
                  <legend class="govuk-fieldset__legend govuk-fieldset__legend--m">


                  </legend>

                  {{ xGovukAutocomplete({
                  id: "country",
                  name: "which-producer",
                  allowEmpty: false,
                  label: {
                  classes: "govuk-body--m",
                  showAllValues: true,
                  isPageHeading: true,
                  text: "Enter PRN or PERN number, or the name of the reprocessor or exporter."
                  },
                  items: [
                  { text: "Valpak (EA), CRN100002" },
                  { text: "MRKWRGHT LTD" },
                  { text: "GREEN LTD" },
                  { text: "Packcare" },
                  { text: "Nipak Ltd (NIEA)" },
                  { text: "BiffPack (EA)" },
                  { text: "BiffPack (GB)" },
                  { text: "Toddpak" },
                  { text: "ComplyPak (NIEA)" },
                  { text: "Co2 Compliance (SEPA)" },
                  { text: "Scotpak (SEPA)" },
                  { text: "Ecosurety Scotland" },
                  { text: "Pennine-Pack (EA)" },
                  { text: "SWS Compak" },
                  { text: "ER454545540M" },
                  { text: "ER454545541M" },
                  { text: "ER454545542M" },
                  { text: "ER454545543M" },
                  { text: "ER454545545M" },
                  { text: "ER454545546M" },
                  { text: "Tesco" },
                  { text: "ASDA" },
                  { text: "B&Q" }
                  ]
                  }) }}



              </fieldset>
          </div>

          <input class="govuk-button" type="submit" value="Search"  />

      </form>
</div>


</div>

</div>

                <hr class="govuk-section-break govuk-section-break--xl govuk-section-break--visible">

             
                
<!--Filter and sorting starts-->

<div class="govuk-form-group" style="float:right; margin-bottom: 20px; margin-right: 10px;">
<a href="#" class="govuk-link" style="margin-right: 10px;">Clear sort and filter</a>
</div>


<div class="govuk-form-group" style="float:right; margin-right: 10px;">
  <label class="govuk-label" id="label1" for="select-filter">
    Filter by
  </label>
  <!--<div id="location-hint" class="govuk-hint">
      This can be different to where you went before
    </div>-->
  <select class="govuk-select" id="select-filter" name="filter" aria-labelledby="label1">
    <option selected>All statuses</option>
    <option value="accepted">Accepted</option>
    <option value="awaiting">Awaiting acceptance</option>
    <option value="cancelled">Cancelled</option>
    <option value="rejected">Rejected</option>
    <!--<option value="aluminium">Aluminium</option>
    <option value="glass-other">Glass other</option>
    <option value="glass-remelt">Glass re-melt</option>
    <option value="paper-board">Paper, board or fibre-based composite material</option>
    <option value="plastic">Plastic</option>
    <option value="steel">Steel</option>
    <option value="wood">Wood</option>-->
  </select>
</div>

<div class="govuk-form-group" style="float:right; margin-right: 10px;">
  <label class="govuk-label" id="label2" for="select-sort">
    Sort by
  </label>
  <!--<div id="location-hint" class="govuk-hint">
    This can be different to where you went before
  </div>-->
  <select class="govuk-select" id="select-sort" name="sort" aria-labelledby="label2">
    <option value="date-issued-a">Date issued (newest first)</option>
    <option value="date-issued-b">Date issued (oldest first)</option>
    <option value="december-waste">December waste (yes to no)</option>
    <option value="tonnage-a">Tonnage (heaviest first)</option>
    <option value="tonnage-b">Tonnage (lightest first)</option>
    <option value="material-a">Material (A to Z)</option>
    <option value="material-b">Material (Z to A)</option>
  </select>
</div>

  
<!--Filter and sorting end-->


<div class="govuk-table-container">
  <table class="govuk-table responsive-table">
    <thead class="govuk-table__head">
      <tr class="govuk-table__row">
        <th scope="col" class="govuk-table__header" style="width: 15%;">PRN or PERN number</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric">Material</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric">Date issued</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric">December waste</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric">Issued by</th>
        <th scope="col" class="govuk-table__header govuk-table__header--numeric">Tonnage</th>
        <th scope="col" class="govuk-table__header" style="width: 13%;">Status</th>
      </tr>
    </thead>
    
</table>
</div>

<div class="govuk-width-container"></div>
  <main class="govuk-main-wrapper govuk-main-wrapper--l" id="main-content" role="main">
    <div class="govuk-grid-row">
      <div class="govuk-grid-column-two-thirds">
        <h1 class="govuk-heading-l">No PRNs or PERNs found</h1>
        <p class="govuk-body">
          If you searched for a PRN or PERN number, check you entered the correct number.
        </p>
        <p class="govuk-body">
          If you searched for the name of a reprocessor or exporter, check the spelling.
        </p>
      </div>
    </div>
  </main>
</div>

<br>    

    </div>

<script>
  // Example data array
  const data = [
    { prn: 'ER3484743570M', material: 'Paper, board or fibre-based composite material', date: '2025-11-20', waste: 'No', issuedBy: 'XYZ Reprocessing', tonnage: 65, status: 'Awaiting acceptance' },
    { prn: 'EX3484743570M', material: 'Aluminium', date: '2025-11-20', waste: 'No', issuedBy: 'Exporting International', tonnage: 151, status: 'Accepted' },
    { prn: 'EX3484743570M', material: 'Paper, board or fibre-based composite material', date: '2024-12-20', waste: 'Yes', issuedBy: 'Packaging reprocessing Ltd', tonnage: 70, status: 'Accepted' },
    { prn: 'EX3484743570M', material: 'Wood', date: '2025-11-20', waste: 'No', issuedBy: 'Exporting International', tonnage: 100, status: 'Accepted' },
    { prn: 'EX3484743570M', material: 'Paper, board or fibre-based composite material', date: '2025-11-20', waste: 'No', issuedBy: 'XYZ Reprocessing', tonnage: 151, status: 'Accepted' },
    { prn: 'EX3484743570M', material: 'Paper, board or fibre-based composite material', date: '2025-11-20', waste: 'No', issuedBy: 'Exporting International', tonnage: 60, status: 'Accepted' },
    { prn: 'EX3484743570M', material: 'Plastic', date: '2024-12-20', waste: 'No', issuedBy: 'Packaging reprocessing Ltd', tonnage: 100, status: 'Rejected' },
    { prn: 'ER3484743570M', material: 'Glass', date: '2024-12-20', waste: 'No', issuedBy: 'Packaging reprocessing Ltd', tonnage: 70, status: 'Rejected' },
    { prn: 'EX3484743570M', material: 'Steel', date: '2024-12-20', waste: 'Yes', issuedBy: '	Packaging reprocessing Ltd', tonnage: 80, status: 'Cancelled' },

    // Add more data objects here
  ];

  function applyFilters() {
    const filter = document.getElementById('select-filter').value;
    const sort = document.getElementById('select-sort').value;

    let filteredData = data;

    // Apply filter
    if (filter !== 'Filter by') {
      filteredData = filteredData.filter(item => item.status.toLowerCase() === filter.toLowerCase());
    }

    // Apply sort
    if (sort !== 'Sort by') {
      filteredData.sort((a, b) => {
        if (sort === 'date-issued') {
          return new Date(a.date) - new Date(b.date);
        } else if (sort === 'tonnage') {
          return a.tonnage - b.tonnage;
        } else if (sort === 'material') {
          return a.material.localeCompare(b.material);
        }
      });
    }

    // Update table
    const tableBody = document.querySelector('.govuk-table__body');
    tableBody.innerHTML = ''; // Clear existing rows

    filteredData.forEach(item => {
      const row = document.createElement('tr');
      row.className = 'govuk-table__row';
      row.innerHTML = `
        <td class="govuk-table__cell"><a href="#">${item.prn}</a></td>
        <td class="govuk-table__cell">${item.material}</td>
        <td class="govuk-table__cell">${new Date(item.date).toLocaleDateString()}</td>
        <td class="govuk-table__cell">${item.waste}</td>
        <td class="govuk-table__cell">${item.tonnage}</td>
        <td class="govuk-table__cell"><strong class="govuk-tag govuk-tag--${getStatusClass(item.status)}">${item.status}</strong></td>
      `;
      tableBody.appendChild(row);
    });
  }

  function getStatusClass(status) {
    switch (status.toLowerCase()) {
      case 'accepted':
        return 'green';
      case 'awaiting acceptance':
        return 'grey';
      case 'rejected':
        return 'red';
      case 'cancelled':
        return 'yellow';
      default:
        return 'grey';
    }
  }

  document.getElementById('select-filter').addEventListener('change', applyFilters);
  document.getElementById('select-sort').addEventListener('change', applyFilters);
</script>



{% endblock %}
